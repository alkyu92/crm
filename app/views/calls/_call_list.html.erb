<div class="text-center">
    <%= page_entries_info @calls %><br>
    <%= paginate @calls %>
</div>

<hr>
<% if @calls.blank? %>
<div class="text-center">
<%= link_to 'Create Call Log through Opportunity', opportunities_path %>
</div>
<% else %>
<div class="row">
    <div class="col-lg-1 text-center">
        <strong>ID</strong>
    </div>
    <div class="col-lg-2">
        <strong>Description</strong>
    </div>
    <div class="col-lg-2">
        <strong>Call DateTime</strong>
    </div>
    <div class="col-lg-2">
        <strong>Opportunity Name</strong>
    </div>
    <div class="col-lg-2">
        <strong>Account Name</strong>
    </div>
    <div class="col-lg-1">
        <strong>Created At DateTime</strong>
    </div>
    <div class="col-lg-2 text-center">
      <strong>Action</strong>
    </div>
</div>

<% @calls.each do |call| %>
<hr>
<div class="row">
    <div class="col-lg-1 text-center"><%= call.id %></div>
    <div class="col-lg-2"><%= link_to call.description.truncate(50), opportunity_path(call.opportunity, anchor: "call-#{call.id}") %></div>
    <div class="col-lg-2">
      <% if call.call_datetime.blank? %>
      <span style="color: red;">Date not specified</span>
      <% else %>
        <%= call.call_datetime.strftime('%d %b %Y %H:%M:%S') %><br>
        <small>
        (<%= distance_of_time_in_words(call.call_datetime, Time.now) %>
        <% if Time.now > call.call_datetime %>
        ago
        <% elsif Time.now < call.call_datetime %>
        left
        <% end %>
        )
      </small>
      <% end %>
    </div>
    <div class="col-lg-2"><%= link_to call.opportunity.name, opportunity_path(call.opportunity) %></div>
    <div class="col-lg-2"><%= link_to call.opportunity.account.account_name,
account_path(call.opportunity.account) %></div>
    <div class="col-lg-1"><%= call.created_at.strftime('%d %b %Y %H:%M:%S') %></div>
    <div class="col-lg-2 text-center">
      <a href="#" class="dropdown-toggle btn btn-default" data-toggle="dropdown">
        <i class="caret"></i>
      </a>
      <ul class="dropdown-menu">
        <li><%= link_to 'Show', '#', data: {toggle: "modal", target: "#callInfo-#{call.id}"} %></li>
        <li><%= link_to 'Delete', opportunity_call_path(call.opportunity, call),
        method: :delete, data: {confirm: "Are you sure?"}, remote: true %></li>
      </ul>
    </div>
</div>

<%= render 'calls/call_info', call: call %>
<% end %>
<br>
<div class="text-center">
    <%= page_entries_info @calls %><br>
    <%= paginate @calls %>
</div>
<% end %>
